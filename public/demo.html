<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width,initial-scale=1" />

        <title>Speechki Speakers</title>
        <link rel="stylesheet" href="https://cdn.simplecss.org/simple.min.css" />

        <script defer src="/widget.js"></script>
    </head>

    <body>
        <header>
            <h1>Speechki speakers demo</h1>
            <p>Simple form</p>
        </header>

        <main>
            <h2>Form Demo</h2>
            <form id="form">
                <p>
                    <label for="title">
                        Book Title
                    </label><br>
                    <input type="text" id="title" placeholder="Title" name="title" />
                </p>
                <p>
                    <label for="title">ISBN</label><br>
                    <input type="text" id="title" placeholder="ISBN" name="ISBN" />
                </p>
                <p>
                    <label for="language">Language</label><br>
                    <select name="language" id="language">
                        <option selected value="english">English</option>
                    </select>
                </p>
                <p>
                    <label for="speaker">
                        Speaker
                    </label><br>
                    <div style="max-height: 300px" id="widget1"></div>
                </p>
                <button>Submit</button>
            </form>
        </main>
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                const w1 = Speechki.widget({
                    target: '#widget1',
                    customer_id: 3,
                    book_language: 'english',
                });

                language.addEventListener('change', function (event) {
                    w1.changeLanguage(event.target.value);
                });

                let speaker;

                w1.on('select', (event) => {
                    speaker = event.data.slug;
                });
                

                console.log(form);
                
                form.addEventListener('submit', (event) => {
                    event.preventDefault();

                    let data = new FormData(event.target);
                    
                    data.append('speaker', speaker);
                    
                    data = JSON.stringify(Object.fromEntries(data));
                    
                    alert(data);
                })
            });
        </script>
    </body>
</html>
